# 如何用C2(Construct 2)制作游戏  

## 新建空白项目

首先启动Construct 2，依次单击File -> New。


![](images\QQ截图20181009163654.png) 

你将看到"*Template or Example*"对话框，单击底部的Open即可创建一个空白项目。
![](images\QQ截图20181009154624.png)

你会看到如下所示界面:
![](images\QQ截图20181009165700.png)

## 插入对象

### 平铺背景

首先，我们需要为界面平铺游戏背景，将下图保存于你的电脑中的某处：

![](https://www.scirra.com/images/articles/bg.png)

现在，双击布局中的空格以插入新对象。出现"*Insert new object*"对话框后，双击"**Tiled Background**"将其插入。

![](images\QQ截图20181009170832.png)

这时，将出现一个十字准线，指示放置对象的位置。单击布局中间附近的某个位置，纹理编辑器会立即打开。现在我们导入您之前保存的图块图像。单击文件夹图标以从磁盘加载纹理，找到将文件保存的位置，然后选择它。

![](images\QQ截图20181009171412.png)

单击右上角的**X**关闭纹理编辑器，再次单击空白处，在窗口左端会看到*Properties*框，如下所示，拷贝*Layout Size*所对应的数字：

![](images\QQ截图20181009172337.png)

单击选中刚才插入的图块图像，窗口左端出现如下显示：

![](images\QQ截图20181009172616.png)

将*Position*对应值改为0,0,*Size*对应值改为改为刚才拷贝的数字。我们可以看到，游戏背景已经被我们平铺。

![](images\QQ截图20181009172929.png)


这时，你可以同时按住Ctrl键并调节鼠标滚轮来缩放布局大小以寻找你最舒适的制作体验。

### 添加图层

布局可以包含多个图层，您可以使用这些图层对对象进行分组。想象一下像玻璃板堆叠在一起的层，每个板上都涂有物体。它允许您轻松地排列哪些对象出现在其他对象之上，并且可以隐藏，锁定图层，应用视差效果等等。例如，在这个游戏中，我们希望所有内容都显示在平铺背景之上，因此我们可以在其他对象的顶部创建另一个图层。

要管理图层，请单击"*Projects*"框中的"**Layers**"选项卡，如图所示：

![](images\QQ截图20181009190148.png)

你将在列表中看到第0层，单击铅笔图标将其重命名为*Background*。

![](images\QQ截图20181009190500.png)
再单击添加图标加入新图层，称之为Main。最后，如果单击“ 背景”旁边的小挂锁图标，它将被锁定。这意味着您将无法选择任何内容。这对我们的平铺背景非常方便。但是，如果您需要进行更改，只需再次单击挂锁即可解锁。

![](images\QQ截图20181009191044.png)

现在，确保在图层栏中选择了"Main"图层。这很重要，所选图层是活动图层。所有新插入的对象都插入到活动层中，因此如果未选中，我们将意外插入到错误的层。活动图层显示在状态栏中，在放置新对象时也会显示在工具提示中。

![](images\QQ截图20181009191929.png)

### 添加输入对象
将注意力转回布局。双击以插入另一个新对象。这次，选择*Mouse*对象，因为我们需要鼠标输入。对*Keyboard*对象再次执行相同操作。


*注意：这些对象不需要放置在布局中。它们是隐藏的，并自动在项目范围内工作。现在我们项目中的所有布局都可以接受鼠标和键盘输入。*

### 游戏对象

像以前一样，将下列图片保存在你的电脑中：

*Player*：

![](https://www.scirra.com/images/articles/player.png)

*Monster*:

![](https://www.scirra.com/images/articles/monster.png)

*Bullet*:

![](https://www.scirra.com/images/articles/Bullet.png)

*Explosion*:

![](https://www.scirra.com/images/articles/explode.png)

现在我们将上述游戏对象插入:


1.双击布局；


2.双击"*Sprite*"对象；


3.当鼠标变为十字准线时，单击布局中的某个位置。工具提示应为“Main”。（请记住这是活动布局。）


4.弹出纹理编辑器。单击打开图标，然后加载四个纹理中的一个。


5.关闭纹理编辑器，保存更改。您现在应该在布局中看到对象。



**你也可以通过一次移动一个对象的方式将图片拖入布局中。**


根据需要将四个对象重命名为Player，Monster，Bullet和Explosion。您可以通过选择对象，然后更改属性栏中的Name属性来执行此操作：

![](images\QQ截图20181009193507.png)

## 添加行为

### 如何添加行为

先单击需要添加行为的对象，单击*Player*，属性栏中，如下所示选择：

![](images\QQ截图20181009200609.png)

点击添加按钮，再双击"*8 Direction*"以添加行为(*8 Direction*使玩家可以通过方向键来控制*Player*的移动)：

![](images\QQ截图20181009200637.png)

执行同样操作，再将"*Scroll To*"和"*Bound To Layout*"添加到*Player*的行为中，最终如下所示(*Scroll To*使*Player*移动时屏幕跟随移动，*Bound To Layout*使*Player*活动区域局限在图层内，不在区域外游荡)：

![](images\QQ截图20181009200726.png)

此时，你可单击下图所示的*Run Layout*，尝试体验一下吧!

![](images\QQ截图20181009200755.png)

### 添加其他行为

学习如何添加行为后，我们为其他几个游戏对象也添加行为：

1.将*Movements*下的*Bullet*和*General*下的*Destroy Outside Layout*添加到Bullet对象。(*Destroy Outside Layout*对我们的子弹很有用。没有它，子弹将永远飞离屏幕，总是占用一点内存和处理能力。相反，我们应该在他们离开布局后销毁子弹。)
2.将*Movements*下的*Bullet*添加到Monster对象。
3.将*General*下的*Fade*添加到*Explosion*对象（因此它出现后会逐渐消失）。默认情况下，*Fade*行为也会在淡出后破坏对象本身，这也使我们不必担心隐藏的爆炸对象会堵塞游戏。

如果你运行游戏，你可能会注意到唯一不同的是，你可以看到怪物突然快速移动。让我们将它放慢一下。选择*Monster*对象。请注意，自从我们添加了一个行为后，属性栏中出现了一些额外的属性：

![](images\QQ截图20181009230925.png)

我们将*Monster*的*Speed*改为80；*Bullet*的*Speed*改为600,将*Explosion*的淡出时间改为0.5秒。

### 创造一些更多的怪物

当我们同时按住Ctrl键并拖拉游戏对象时，可快速生成另一个同样的对象。效果如下所示:

![](images\2.gif)

## 活动

首先，单击顶部的"Event sheet 1"选项卡以切换到事件表编辑器。事件列表称为事件表，您可以为游戏的不同部分或组织设置不同的事件表。事件表还可以"包含"其他事件表，例如，允许您在多个级别重用事件，但我们现在不需要它。

![](images\QQ截图20181009235544.png)

### 关于活动

![](images\QQ截图20181009235710.png)

正如空白工作表中的文字所示，Construct 2每个tick都会在事件表中运行一次。且事件从上到下运行，因此事件表顶部的事件首先运行。

### 条件，行动和子事件

事件由条件组成，测试是否满足某些条件，如果满足所有这些条件，则事件的所有操作都会运行，如果不满足，则跳到下一个事件(不包括任何子事件)。运行后，任何子事件也会运行，然后可以测试更多条件，然后运行更多操作，然后运行更多子事件，等等。使用此系统，我们可以为我们的游戏和应用程序构建复杂的功能。但是，我们本教程中不需要子事件。

### 你的第一个活动

我们想让*Player*总是看着鼠标。双击事件表中的空格，出现如下所示提示：

![](images\QQ截图20181010000617.png)

依次双击*System*、*Every Tick*:

![](images\QQ截图20181010000933.png)

单击上图中的*Add action*，依次双击*Player*、*Set angle toward position*(这将自动计算从玩家到给定的X和Y坐标的角度，然后将对象的角度设置为该角度，方便):

![](images\QQ截图20181010001525.png)

现在需要知道X和Y坐标以指向玩家，这些被称为动作的参数。条件也可以有参数，但每个tick不需要任何参数。


我们想要将角度设置为鼠标位置。Mouse对象可以提供此功能。输入Mouse.X为X，和Mouse.Y为Y。这些被称为表达式。它们就像计算的总和。例如，您也可以输入Mouse.X + 100或sin（Mouse.Y）（尽管这些特定示例可能不太有用！）。这样，您可以使用来自任何对象或任何计算的任何数据来计算操作和条件中的参数。它非常强大，是Construct 2灵活性的一大隐藏源。

完成后，如下所示：

![](images\QQ截图20181010001935.png)

这是你的第一个活动！尝试运行游戏，玩家现在可以像以前一样移动，但总是面向鼠标。这是我们的第一个自定义功能。

# 添加游戏功能

让我们为下一个事件做一些简短的描述。请记住，添加条件或操作的步骤如下：

1.双击以插入新事件，或单击"Add event"以添加操作。


2.双击条件/操作所在的对象。


3.双击所需的条件/操作。


4.输入参数（如果需要）。

我们可以简写成：

**Add condition** System -> Every tick

**Add action** Player -> Set angle towards position -> X: Mouse.X, Y: Mouse.Y

## 让玩家开枪

当玩家点击时，*Player*应该射击子弹。这可以通过Spawn中的对象动作来完成：

**Condition**: Mouse -> On click -> Left clicked (the default)

**Action**: Player -> Spawn another object -> For Object, choose the Bullet objec t-> For Layer, put 1 (the "Main" layer is layer 1) -> Leave Image point as 0.

完成后如下所示：

![](images\QQ截图20181010003155.png)

如果你运行游戏，你会注意到子弹从玩家中间射击，而不是从枪尾射出。让我们通过在枪的末端放置一个图像点(*imagine point*)来解决这个问题。（图像点只是图像上可以从中生成对象的位置。）

右击**Objects**中的*Player*，然后选择"*Edit animations*"(编辑动画)：

![](images\QQ截图20181010003626.png)

单击原点和图像点工具：

![](images\QQ截图20181010070832.png)

请注意，对象原点对象的“热点”或“枢轴点”。如果旋转对象，它会围绕原点旋转。我们想要添加另一个图像点来表示枪，所以单击添加按钮。出现新图像点。在玩家枪的末端单击鼠标左键，将图像点放在那里：

![](images\QQ截图20181010071149.png)

关闭图像编辑器。双击我们之前添加的Spawn操作，并将*Image point*更改为1。

效果如下：

![](images\QQ截图20181010071432.png)

运行游戏。子弹现在从枪的末端射击！然而，子弹还没有做任何事情。但是，希望您开始意识到，一旦掌握了事件系统，您就可以非常快速地将功能集中在一起。

让子弹杀死怪物。添加以下事件：

**Condition**: Bullet -> On collision with another object -> pick Monster.

**Action**: Monster -> Destroy

**Action**: Bullet -> Spawn another object -> Explosion, layer 1

**Action**: Bullet -> Destroy

### 爆炸效果

运行游戏，尝试射击怪物。哎呀，爆炸有那么大的黑色边框！

![](https://www.scirra.com/images/articles/explosionnoadditive.png)

单击右下角的*Objects*中的Explosion对象，或单击项目栏（带有图层栏的选项卡）。其属性显示在左侧的属性栏中。在底部，将其*Blend mode*属性设置为*Additive*。现在再试一次游戏。

![](https://www.scirra.com/images/articles/explosionadditive.png)

效果很好，为什么这样做？

一般情况下，普通图像将粘贴在屏幕顶部。利用加性效应，每个像素被添加（如在其中，求和）与其后面的背景像素。黑色是零像素值，因此不添加任何内容，您没有看到黑色背景。更亮的颜色会增加更多，所以显得更强烈。它非常适合爆炸和灯光效果。

### 使怪物变得更聪明

现在，怪物只是偏离布局向右。让我们让它们变得更有趣。首先，让我们以随机的角度开始它们。


**Condition**: System -> On start of Layout
**Action**: Monster -> Set angle -> random(360)

当他们离开布局时，他们仍会永远徘徊，再也不会被人看到。让我们把它们留在里面。我们要做的是当他们离开布局时将他们指回玩家。这样做有两件事：它们总是留在布局中，如果玩家静止不动，怪物就会出现在他们面前！

**Condition**: Monster -> Is outside layout
**Action**: Monster -> Set angle toward position -> For X, Player.X - for Y, Player.Y.

运行游戏。如果你闲逛了一会儿，你会注意到怪物也会在布局周围停留，他们会走向各种各样的方向。

现在，假设我们想要在它死前五次射击怪物，而不是像现在这样瞬间死亡。我们怎么做？如果我们只存储一个“health”计数器，那么一旦我们击中一个怪物五次，所有的怪物都会死亡。相反，我们需要每个怪物记住自己的健康。我们可以用实例变量做到这一点。

## 实例变量

实例变量允许每个怪物存储自己的健康值。变量只是一个可以改变（或变化）的值，它们是为每个实例单独存储的，因此是名称实例变量。

让我们为我们的怪物添加一个“health”实例变量。单击项目栏或对象栏中的怪物。或者，您可以切换回布局并选择怪物对象。这将在属性栏中显示怪物的属性。点击添加/编辑通过编辑变量。

![](images\QQ截图20181010081250.png)

在弹出的对话框中，键入health作为名称，将Type保留为Number，对于Initial value，输入5。这启动了5个生命值的每个怪物。当它们被击中时，我们将从健康状态中减去1，然后当健康状态为零时，我们将摧毁该物体。

完成后，单击“OK”。请注意，变量现在出现在实例变量对话框中，也出现在怪物的属性中。

![](images\QQ截图20181010081735.png)

### 改变事件

切回活动表中，作如下改动：

![](images\QQ截图20181010082615.png)

![](images\QQ截图20181010082730.png)

完成后如图所示：

![](images\QQ截图20181010082811.png)

添加另一个事件(杀死怪物)：

**Condition**: Monster -> Compare instance variable -> Health, Less or equal, 0
**Action**: Monster -> Spawn another object -> Explosion, layer 1
**Action**: Monster -> Destroy

为什么“小于或等于0”而不是“等于0”？假设我们添加了另一个更强大的武器，从健康中减去2。当你打出了怪兽，它的健康会去5，3，1，-1，-3 ......在任何时候通知是它的健康直接等于零，所以它永远不会死！因此，最好使用“少或平等”来测试健康状况是否已经用完。

运行游戏。你现在必须击中怪物五次才能杀死他们！

### 保持得分

对于得分，我们使用全局变量(否则如果使用实例变量，*Player*一被破坏，分数就不见了)

与实例变量一样，全局变量可以存储文本或数字。每个变量可以存储单个数字或单个文本。全局变量也适用于所有布局的整个游戏 - 如果我们要添加其他级别，则非常方便。

右键单击事件表底部的空间，然后选择“*Add global variable*”。

再输入Score作为名称。其他字段默认值为OK，它将使其成为从0开始的数字。

现在全局变量在事件表中显示为一行。它位于此事件表中，但可以从任何布局中的任何事件表访问它。

![](images\QQ截图20181010083700.png)

让我们给玩家一个杀死怪物的分数。

在我们的“Monster：health less or equal 0”事件中（当怪物死亡时），单击Add action，然后选择System - > Add to（在Global和local variables下） - > Score，value 1。

现在该事件应如下所示：

![](images\QQ截图20181010083948.png)


现在玩家有一个分数，对于他们杀死的每个怪物都会增加1分 - 但他们看不到他们的分数！让我们用文本对象向他们展示。

## 创建平视显示器(HUD)

平视显示器（也称为HUD）是显示玩家在游戏中的健康，得分和其他信息的界面。让我们从文本对象中制作一个非常简单的HUD。

HUD始终保持在屏幕上的相同位置。如果我们有一些界面对象，我们不希望它们随着玩家走动而滚动 - 它们应该留在屏幕上。默认情况下，图层滚动。要将它们保留在屏幕上，我们可以使用图层Parallax设置。视差允许不同的层以不同的速率滚动以实现一种半3D效果。但是，如果我们将视差设置为零，那么该层根本不会滚动 - 非常适合HUD。

回到我们之前使用的图层栏。添加一个名为HUD的新图层。确保它位于顶部并选中（记住这使它成为活动层）。属性栏现在应该显示其属性。将Parallax属性设置为0,0（在X和Y轴上均为零）。

双击空格以插入另一个对象。这次选择Text对象。将其放在布局的左上角。很难看出它是否是黑色的，所以在属性栏中，使其变为粗体，斜体，黄色，并选择稍大的字体大小。将其大小调整到足以容纳合理数量的文本。它应该看起来像这样：

![](https://www.scirra.com/images/articles/textinlayout.png)

插入的Text对象。
切换回活动表。让我们用播放器的分数更新文本。在我们之前添加的Every tick事件中，添加操作Text - > Set text。

使用＆运算符，我们可以将数字转换为文本并将其连接到另一个文本字符串。因此，对于文本，请输入：

"Score: " & Score

第一部分（“Score”）是指文本将总是以这句话开始"Score："第二部分（Score）是Score全局变量的实际值。

运行游戏，杀死一些怪物。您的分数会显示，并且会保留在屏幕上的相同位置！

## 完成接触

首先，让我们有一些怪物经常产卵，否则一旦你射杀了所有的怪物，就没有什么可做的了。我们将每3秒创建一个新怪物。添加新活动：

**Condition**: System -> Every X seconds -> 3
**Action**: System -> Create object -> Monster, layer 1, 1400 (for X), random(1024) (for Y)

1400是紧邻布局右边缘的X坐标，random(1024)是随机Y坐标布局的高度。(您可根据自己的布局大小及兴趣来设定这些坐标)

最后，让怪物杀死玩家。

**Condition**: Monster -> On collision with another object -> Player
**Action**: Player -> Destroy


## 运行游戏

效果如下所示：

![](images\1.gif)

现在你已经完成了游戏，接下来你可以去尝试添加"Game Over"等提示，或者音乐效果，快去尝试吧！