# 下载的原理

　　我们平时在下载的时候，会遇到很多种下载方式，比如HTTP，FTP，P2P等等，今天我就来简要介绍一下各种下载方式的原理。

## 来归下类

1.http、ftp、https等传统下载方式；

2.P2P及BT1.0

3.BT2.0——磁力链接

## 简要介绍

1.**http、ftp、https**等在我们日常上网中再寻常不过了，我们经常在浏览器看到如下所示下载框：

![](images\timg.jpg)

这就是常见的http下载方式，ftp与https也类似如此。

优点：下载直接在浏览器中进行，不需要另外的软件；

缺点：这三类下载方式为中央节点应用，也就是说，客户的下载依赖于服务器，假设下载的用户多，那么将造成下载速度慢等问题；假设服务器崩溃，也将导致所有用户下载失败。

这些下载方式即对应下图**Client/Server结构(C/S结构)**模式：

![](http://yzhtml01.book118.com/2016/09/17/03/27821267/8.files/file0002.jpg)

2.提到上述中央节点的概念，我们会不自然地想要摆脱这种窘况，其实早在20世纪60年代，美国国防部高级研究计划署（DARPA）提出要研制一种崭新的、能够适应现代战争的、生存性很强的网络——**ARPANET**，当今互联网的雏形，


**ARPANET**的宗旨之一是去中心化，原因很简单，存在中央节点无异于存在致命节点，单点失效，将导致整个网络功能失效。

于是便出现了**P2P**(Peer-to-peer networking)

如图所示：

![](https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike92%2C5%2C5%2C92%2C30/sign=715ed9386259252db71a155655f2685e/960a304e251f95ca796fa994cb177f3e6709527d.jpg)

再结合引用自百度百科的解释：

　“对等网络，即对等计算机网络，是一种在对等者（Peer）之间分配任务和工作负载的分布式应用架构，是对等计算模型在应用层形成的一种组网或网络形式。“Peer”在英语里有“对等者、伙伴、对端”的意义。因此，从字面上，P2P可以理解为对等计算或对等网络。国内一些媒体将P2P翻译成“点对点”或者“端对端”，学术界则统一称为对等网络（Peer-to-peer networking）或对等计算（Peer-to-peer computing），其可以定义为：网络的参与者共享他们所拥有的一部分硬件资源（处理能力、存储能力、网络连接能力、打印机等），这些共享资源通过网络提供服务和内容，能被其它对等节点（Peer）直接访问而无需经过中间实体。在此网络中的参与者既是资源、服务和内容的提供者（Server），又是资源、服务和内容的获取者（Client）。

　　在P2P网络环境中，彼此连接的多台计算机之间都处于对等的地位，各台计算机有相同的功能，无主从之分，一台计算机既可作为服务器，设定共享资源供网络中其他计算机所使用，又可以作为工作站，整个网络一般来说不依赖专用的集中服务器，也没有专用的工作站。网络中的每一台计算机既能充当网络服务的请求者，又对其它计算机的请求做出响应，提供资源、服务和内容。通常这些资源和服务包括：信息的共享和交换、计算资源（如CPU计算能力共享）、存储共享（如缓存和磁盘空间的使用）、网络共享、打印机共享等。”


　　我们不难提炼出P2P非中心化的特点：网络中的资源和服务分散在所有节点上，信息的传输和服务的实现都直接在节点之间进行，可以无需中间环节和服务器的介入，避免了可能的瓶颈。

　　而互联网上依靠中央节点才能正常工作的应用其实不在少数，比如我们再熟悉不过的BT。也许你会说：BT不是P2P下载吗？而P2P是没有中心节点的，我们所下载的文件实际上存放在每个网友的电脑中，像FTP这样的应用才是经典的中央节点应用——这话只说对了一半，BT是P2P应用没错，但如果说BT没有中心节点，不会出现“单点失效”，这种看法其实是错误的。
仔细想一想，BT真的不需要中心节点吗？如果是，那为什么国内BT站点关闭后会给下载BT资源带来不便，甚至出现BT客户端无法工作的情况(如2009年12月，中华人民共和国广电总局对BTchina一系列的tracker进行打击)？答案只有一个，BT并非一个去中心化的应用。
　　
　　上文提到，BT并非一个去中心化的应用。它还需利用到BitTorrent tracker（中文可称：BT服务器、tracker服务器等），它是帮助BitTorrent协议在节点与节点之间做连接的服务器。BitTorrent客户端下载一开始就要连接到tracker，从tracker获得其他客户端IP地址后，才能连接到其他客户端下载。在传输过程中，也会一直与tracker通信，上传自己的信息，获取其它客户端的信息。

　　由于tracker对BT下载起到客户端协调和调控的重要作用，所以一旦被封锁会严重影响BT下载。因此也促使新BT客户端支持**DHT网络**实现无中心tracker，分布式资源分享的影响。

　　在BT1.0到BT2.0过渡间，有这么一个小插曲：（引用自百科）
[海盗湾的故事](海盗湾的故事)

